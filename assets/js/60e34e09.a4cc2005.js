"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[782],{1995:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"docs/guides/configuration","title":"Configuration","description":"Each query or infinite query can be configured using the QueryConfig.","source":"@site/docs/docs/guides/04-configuration.md","sourceDirName":"docs/guides","slug":"/docs/guides/configuration","permalink":"/docs/guides/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/D-James-GH/cached_query/tree/main/docs/docs/docs/guides/04-configuration.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"docs","previous":{"title":"Query","permalink":"/docs/guides/query"},"next":{"title":"Mutations","permalink":"/docs/guides/mutations"}}');var r=t(4848),a=t(8453);const o={},s="Configuration",l={},c=[{value:"Stale Duration",id:"stale-duration",level:3},{value:"Cache Duration",id:"cache-duration",level:3},{value:"Serialization",id:"serialization",level:3},{value:"Should Rethrow",id:"should-rethrow",level:3},{value:"Should fetch",id:"should-fetch",level:3},{value:"Polling / Refetch Duration",id:"polling--refetch-duration",level:3},{value:"Global Configuration",id:"global-configuration",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,r.jsx)(n.p,{children:"Each query or infinite query can be configured using the QueryConfig."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"final config = QueryConfig(\n  storageSerializer: null,\n  storageDeserializer: null,\n  ignoreCacheDuration: false,\n  storeQuery: true,\n  staleDuration: Duration(seconds: 4),\n  cacheDuration: Duration(minutes: 5),\n  shouldRethrow: false,\n  shouldRefetch: null,\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stale-duration",children:"Stale Duration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"staleDuration"}),", which defaults to 4 seconds is the amount of time after a request and before the data is marked\nas stale. So if a query is requested twice in 4 seconds there will be no call made to the queryFn, however, if a request\nis made after 4 seconds the data will be assumed to be stale and re-fetched."]}),"\n",(0,r.jsx)(n.h3,{id:"cache-duration",children:"Cache Duration"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"cacheDuration"})," is the length of time between the last listener being removed from a query and the query being deleted\nfrom the cache. The time can be ignored completely using ",(0,r.jsx)(n.code,{children:"ignoreCacheDuration"}),", however using this would mean the query\nis never removed from memory."]}),"\n",(0,r.jsx)(n.h3,{id:"serialization",children:"Serialization"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"storageSerializer"})," and ",(0,r.jsx)(n.code,{children:"storageDeserializer"})," are used to transform the data to and from the storage interface.\nIf you are using ",(0,r.jsx)(n.a,{href:"https://pub.dev/packages/cached_storage",children:"Cached Storage"})," then the data is always stored as json, so you would use the\nstorageSerializer to turn it back to the required object. Individually choose to store a query or not with ",(0,r.jsx)(n.code,{children:"storeQuery."})]}),"\n",(0,r.jsx)(n.h3,{id:"should-rethrow",children:"Should Rethrow"}),"\n",(0,r.jsxs)(n.p,{children:["By default, a query catches any error and emits it as part of the query state. However, in development it is sometimes\nuseful to have the query rethrow to quickly see the full stacktrace in the console, to do this set ",(0,r.jsx)(n.code,{children:"shouldRethrow"})," to\ntrue."]}),"\n",(0,r.jsx)(n.h3,{id:"should-fetch",children:"Should fetch"}),"\n",(0,r.jsx)(n.p,{children:"Should fetch callback is rarely necessary but it can offer more flexibility on when a query should be fetched.\nBy default the should fetch callback is null, this is the recommended setting and in most cases you will not need to\nuse it."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"QueryConfig(\n    // This will prevent any fetch from happening.\n    shouldFetch: (key, data, createdAt) => false,\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"polling--refetch-duration",children:"Polling / Refetch Duration"}),"\n",(0,r.jsxs)(n.p,{children:["A query can be set to automatically refetch at a given interval using the ",(0,r.jsx)(n.code,{children:"pollingDuration"})," parameter.\nThis is a function that will be called every time the query status changes. If a non-null duration is returned then the query will\nautomatically refetch at that interval."]}),"\n",(0,r.jsxs)(n.p,{children:["By default the polling only affects active queries, meaning queries with listeners. However, this can be changed using the ",(0,r.jsx)(n.code,{children:"pollInactive"}),"\nparameter."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"QueryConfig(\n  staleDuration: Duration.zero,\n  pollInactive: true,\n  pollingInterval: (state) {\n    if (state.isError) {\n      return null;\n    }\n    return const Duration(milliseconds: 5000);\n  },\n)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"global-configuration",children:"Global Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Global configuration can be set when instantiating a Cache or once by configuring the global instance."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"CachedQuery.instance.config(\n  config: GlobalQueryConfig(\n    refetchDuration: Duration(seconds: 10),\n    cacheDuration: Duration(minutes: 2),\n  ),\n);\n"})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>s});var i=t(6540);const r={},a=i.createContext(r);function o(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);